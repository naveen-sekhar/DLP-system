import pyclamd
import os

# Initialize ClamAV scanner
cd = pyclamd.ClamdUnixSocket()
cd.ping()  # Check if ClamAV is running

def scan_file(file_path):
    """ Scan a file for malware """
    result = cd.scan_file(file_path)
    if result:
        return f"Malware detected: {result}"
    return "No malware detected."

def scan_directory(directory_path):
    """ Scan an entire directory """
    for root, dirs, files in os.walk(directory_path):
        for file in files:
            file_path = os.path.join(root, file)
            result = scan_file(file_path)
            print(result)
